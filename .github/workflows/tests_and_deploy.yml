name: Tests and deploiement of ceri-m2-ecommerce-2022
on:
  push:
    branches: ["develop", "main"]
  pull_request:
    branches: ["develop", "main"]

jobs:
  unit_test:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Tests with unittest
        run: python backend/tests/unit_tests.py
     
      - name: Pylint
        run: |
          pylint --fail-under=9 backend/.
  
#  deploy:
#    runs-on: ubuntu-latest
#    needs: unit_test
#    defaults:
#      run:
#        working-directory: terraform
#    
#    steps:
#      - uses: actions/checkout@v2
#      - uses: hashicorp/setup-terraform@v2
#        with:
#          cli_config_credentials_token: ${{ secrets.TF_API_TOKEN }}
#      - run: terraform init
#      - run: terraform apply -auto-approve -input=False